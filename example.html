<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Pré-remplissage PDF</title>
  <script src="https://unpkg.com/pdf-lib/dist/pdf-lib.min.js"></script>
</head>
<body>
  <h1>Formulaire d’adhésion</h1>
  <label for="name">Nom :</label>
  <input type="text" id="name" placeholder="Jean Dupont" />
  <button onclick="remplirPDF()">Générer le PDF</button>

  <script>
    async function remplirPDF() {
      const nom = document.getElementById("name").value;

      // Chargement du PDF vierge (à adapter selon ton hébergement)
      const existingPdfBytes = await fetch("http://localhost:8000/static/adhesion.pdf").then(res => res.arrayBuffer());

      const pdfDoc = await PDFLib.PDFDocument.load(existingPdfBytes);
      const pages = pdfDoc.getPages();
      const firstPage = pages[0];

      const { width, height } = firstPage.getSize();

      // Ajout du texte (adapter les coordonnées selon ton PDF)
      firstPage.drawText(nom, {
        x: 100,
        y: height - 150, // vers le haut de la page
        size: 18,
        color: PDFLib.rgb(0, 0, 0),
      });

      // Export du PDF modifié
      const pdfBytes = await pdfDoc.save();

      // Téléchargement
      const blob = new Blob([pdfBytes], { type: "application/pdf" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "adhesion_remplie.pdf";
      link.click();
    }
  </script>
</body>
</html>
